<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Ingredient Checker — SkinCare AI</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <main class="container">
    <a href="index.html" style="text-decoration:none; color:var(--muted)">← Back</a>
    <section class="page" style="margin-top:12px;">
      <h2>Ingredient Checker</h2>
      <p class="small">Paste product ingredient list (comma or newline separated).</p>

      <form id="ingredientsForm">
        <div class="form-row">
          <label for="ingredients">Ingredients</label>
          <textarea id="ingredients" name="ingredients" class="input" placeholder="e.g. Water, Glycerin, Panthenol" required></textarea>
        </div>

        <div class="form-row">
          <label for="acne_level">Acne level</label>
          <input id="acne_level" name="acne_level" class="input" type="number" min="0" max="5" value="2" required />
        </div>

        <div class="form-row">
          <label for="skin_type">Skin type</label>
          <input id="skin_type" name="skin_type" class="input" type="number" min="0" value="2" required />
        </div>

        <div class="form-row">
          <label for="skin_tone">Skin tone</label>
          <input id="skin_tone" name="skin_tone" class="input" type="number" min="0" value="1" required />
        </div>

        <div class="form-row">
          <label for="sensitive">Sensitive</label>
          <select id="sensitive" name="sensitive" class="input">
            <option value="false" selected>No</option>
            <option value="true">Yes</option>
          </select>
        </div>

        <div style="display:flex; gap:12px; margin-top:12px;">
          <button type="submit" class="btn btn-primary">Analyze Ingredients</button>
          <button type="reset" class="btn btn-ghost">Reset</button>
        </div>
      </form>
    </section>
  </main>

  <script src="app.js"></script>
  <script>
    const form = document.getElementById('ingredientsForm');

    form.addEventListener('submit', async (ev)=>{
      ev.preventDefault();
      const body = new URLSearchParams();
      body.append('ingredients', document.getElementById('ingredients').value);
      body.append('acne_level', document.getElementById('acne_level').value);
      body.append('skin_type', document.getElementById('skin_type').value);
      body.append('skin_tone', document.getElementById('skin_tone').value);
      body.append('sensitive', document.getElementById('sensitive').value);

      try {
        showMessage('Contacting API...');
        const res = await fetch(BASE_URL + '/ingredient-check', {
          method: 'POST',
          headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
          body: body.toString()
        });
        const data = await res.json();
        if(!res.ok){ showMessage('API error'); return; }
        storeAndNavigate('ingredients_response', data, 'ingredients-result.html');
      } catch(err){
        showMessage('Request failed: ' + err.message);
      }
    });
  </script>
</body>
</html>
