<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Compare — SkinCare AI</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <main class="container">
    <a href="index.html" style="text-decoration:none; color:var(--muted)">← Back</a>
    <section class="page" style="margin-top:12px;">
      <h2>Compare Products</h2>
      <p class="small">Provide two product names and your skin profile for a comparison.</p>

      <form id="compareForm">
        <div class="form-row">
          <label for="product1">Product 1</label>
          <input id="product1" name="product1" class="input" type="text" required />
        </div>

        <div class="form-row">
          <label for="product2">Product 2</label>
          <input id="product2" name="product2" class="input" type="text" required />
        </div>

        <div class="form-row">
          <label for="acne_level">Acne level</label>
          <input id="acne_level" name="acne_level" class="input" type="number" min="0" value="2" required />
        </div>

        <div class="form-row">
          <label for="skin_type">Skin type</label>
          <input id="skin_type" name="skin_type" class="input" type="number" min="0" value="2" required />
        </div>

        <div class="form-row">
          <label for="skin_tone">Skin tone</label>
          <input id="skin_tone" name="skin_tone" class="input" type="number" min="0" value="1" required />
        </div>

        <div class="form-row">
          <label for="sensitive">Sensitive</label>
          <select id="sensitive" name="sensitive" class="input">
            <option value="false" selected>No</option>
            <option value="true">Yes</option>
          </select>
        </div>

        <div style="display:flex; gap:12px; margin-top:12px;">
          <button type="submit" class="btn btn-primary">Compare</button>
          <button type="reset" class="btn btn-ghost">Reset</button>
        </div>
      </form>
    </section>
  </main>

  <script src="app.js"></script>
  <script>
    const form = document.getElementById('compareForm');

    form.addEventListener('submit', async (ev)=>{
      ev.preventDefault();
      const body = new URLSearchParams();
      body.append('product1', document.getElementById('product1').value);
      body.append('product2', document.getElementById('product2').value);
      body.append('acne_level', document.getElementById('acne_level').value);
      body.append('skin_type', document.getElementById('skin_type').value);
      body.append('skin_tone', document.getElementById('skin_tone').value);
      body.append('sensitive', document.getElementById('sensitive').value);

      try {
        showMessage('Contacting API...');
        const res = await fetch(BASE_URL + '/compare-products', {
          method: 'POST',
          headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
          body: body.toString()
        });
        const data = await res.json();
        if(!res.ok){ showMessage('API error'); return; }
        storeAndNavigate('compare_response', data, 'compare-result.html');
      } catch(err){
        showMessage('Request failed: ' + err.message);
      }
    });
  </script>
</body>
</html>
